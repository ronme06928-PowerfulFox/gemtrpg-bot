<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ジェムリアTRPGダイスボット</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
</head>

<body>

    <div id="entry-portal">
        <div class="login-header">
            <h2>ジェムリアTRPG<br>ダイスボット</h2>
        </div>
        <div class="auth-form">
            <p style="text-align: center; margin-top: 0;">セッションに参加する名前を入力してください。</p>
            <label for="entry-username">あなたの名前:</label>
            <input type="text" id="entry-username" placeholder="プレイヤー名またはGM名">

            <label for="entry-attribute">あなたの属性:</label>
            <select id="entry-attribute">
                <option value="Player">プレイヤー (Player)</option>
                <option value="GM">ゲームマスター (GM)</option>
            </select>

            <button id="entry-btn">ルームポータルへ進む</button>
            <div id="entry-message" class="auth-message"></div>
        </div>
    </div>

    <div id="room-portal" style="display: none;">
    </div>

    <div id="user-management-portal"
        style="display: none; max-width: 800px; margin: 40px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.05);">
        <div
            style="display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 20px;">
            <h2 style="margin: 0; color: #6f42c1;">ユーザー管理 (GM専用)</h2>
            <button id="back-to-room-portal-btn" style="padding: 8px 16px;">ルーム一覧に戻る</button>
        </div>

        <div id="user-list-container">
            <p>ユーザー情報を読み込み中...</p>
        </div>
    </div>
    <div id="main-app-container" style="display: none;">

        <header>
            <h1>ジェムリアTRPGダイスボット</h1>

            <div class="header-room-info">
                <div id="current-room-name">ルーム名: ...</div>

                <div id="current-user-info" class="current-user-info">
                    <span id="header-username">...</span>
                    (<span id="header-attribute">...</span>)
                    <button id="user-settings-btn" class="header-icon-btn" title="ユーザー情報変更">⚙️</button>

                    <button id="user-list-btn" class="header-icon-btn" title="ルーム参加者一覧">👤</button>
                </div>
                <button id="home-portal-btn" class="header-icon-btn" title="ルーム一覧に戻る">🏠</button>

            </div>
        </header>

        <div class="tab-container" style="display:none;"> <!-- タブは非表示だが構造は維持 -->
            <button class="tab-button" data-tab="tab-battlefield">テキストバトルフィールド</button>
            <button class="tab-button" data-tab="visual">ビジュアルバトルフィールド</button>
        </div>

        <div id="main-content">
        </div>

    </div>

    <!-- JavaScriptファイルの読み込み（依存関係順） -->
    <script src="js/buff_data.js"></script>
    <script src="js/legacy_globals.js?v=20260111"></script>
    <script src="js/action_dock.js"></script>
    <script src="js/exploration/exploration_view.js"></script>
    <script src="js/exploration/exploration_dock.js"></script>
    <script src="js/tab_visual_battle.js"></script>
    <script src="js/wide_match_synced.js?v=20260111"></script>
    <script src="js/tab_battlefield.js"></script>
    <script src="js/tab_skill_search.js"></script>
    <script src="js/modals.js"></script>
    <script src="js/image_picker.js"></script>
    <script src="js/item_modal.js"></script>
    <script src="js/user_management.js"></script>
    <script src="js/main.js"></script>
    <script type="module" src="js/battle/index.js"></script>
</body>

</html>